from math import log
from scipy.stats import linregress
import matplotlib.pyplot as plt
from colorsys import hsv_to_rgb
timeIntervalList=[0.01,0.05,0.1,0.2,0.5,1,2,3,4,5,6,7,8,10,20,50,100,200,300,500,1000]
chosenChannels=[10,25,26,49,50,51,"All"]
cvMatrix4=[
    [28.880233682398373, 12.924762226249754, 9.11196011514942, 6.42454138285976, 4.078573393195047, 2.860026036260643, 2.032914481135717, 1.6736080304435716, 1.4352396486499952, 1.2710238343187077, 1.2085845611430697, 1.1255307141402682, 1.0312305648051407, 0.891359790031779, 0.6300105538762427, 0.40629611428651513, 0.2727042639858916, 0.22153528944353532, 0.35256707803463205, 0.2624146605024941, 0.1788259992206293],
    [27.66287149954875, 12.374054357286939, 8.72123864226544, 6.144042980771516, 3.9200337749892866, 2.7445562689161225, 1.963177078419668, 1.5805328643660832, 1.3691095505873014, 1.2452657788311958, 1.1346517390589586, 1.0378883110410817, 0.9638790249472197, 0.8698022267935102, 0.6699716984098489, 0.452242154096783, 0.3445795944832044, 0.2531969637081449, 0.3755161907529798, 0.30243671895858254, 0.2966101694915254],
    [128.4185052725937, 57.42440667726491, 40.599414582862416, 28.699955207971826, 18.136629299355484, 12.806234599488414, 9.031156583420996, 7.352648056795523, 6.349100518182463, 5.662218740265922, 5.15367485050158, 4.756312295143809, 4.436738718465068, 3.9444816340321234, 2.702839897487526, 1.6670322115156533, 1.1709371246996998, 0.830604506461316, 0.7322109071162488, 0.6123724356957946, 0.5412658773652742],
    [26.957403606784364, 12.08751301726234, 8.51802059857181, 6.014340137283478, 3.8281594590154246, 2.7591765581609162, 1.933492999271456, 1.5646342893549754, 1.360141076252294, 1.2092752253654173, 1.106242958237548, 1.0542688797560935, 0.9505981305694015, 0.8703153054842362, 0.6105125705202891, 0.3542034337148495, 0.2960553226749692, 0.22518524974374585, 0.36305253798137915, 0.25987269756287523, 0.14782502241793033],
    [25.432906924641447, 11.338887022780728, 8.277734112889753, 6.156697898646276, 4.49273143937714, 3.5600858540056826, 2.956487144171646, 2.6104780509427217, 2.418354264996501, 2.3881517387699818, 1.9958007616982245, 1.8672509521608918, 2.0452165252297, 1.8704037477952802, 1.605190482312354, 1.1612103392155202, 0.8868460916468232, 0.6470856261537026, 0.5910594125148404, 0.5482485472490195, 0.39091375583810056],
    [26.93748542022466, 12.07767495293883, 8.533577007183908, 6.040739705252999, 3.782423094190896, 2.6753183186815477, 1.8826337396811887, 1.5871817088138978, 1.3715358177100034, 1.2092817910580238, 1.1033096734489332, 0.9734555160294691, 0.9712720872420978, 0.8701282068471079, 0.6234809701703886, 0.4061907759933226, 0.3077507408902837, 0.18416789070251083, 0.3622154055254967, 0.2805708466680029, 0.14816207341961707],
    [2.8657302627623693,1.2719767968561546,0.904235145332319,0.6787633578580022,0.4748883639288479, 0.37153810453166675, 0.29799969233034757, 0.2705621766754984, 0.255348591940763, 0.24431146317620145, 0.2429015829375028, 0.2349738648969342, 0.23402996569322154, 0.22887122167097154,0.21324492806233608,0.2256801223961945, 0.2613832681288978, 0.20653767276729346,0.385004756924808,0.2662906699206589, 0.025211668871361146]  
]

# need to do all
cvMatrix13=[
[16.01580271012786, 7.724106575982784, 5.937946643972656, 4.618312732110308, 3.3107457268082725, 2.454301591098822, 1.8378407608610154, 1.4697532692451791, 1.2701266598710015, 1.1461660448771336, 1.0573633993563905, 0.9543919393798346, 0.9171617976938574, 0.8238194903903241, 0.6353075767282417, 0.4707992976452646, 0.40756221179575525, 0.297234082208699, 0.4358846486753721, 0.35488346015447836, 0.3456922476258505],
[22.00054353447353, 12.453353511128933, 10.886618480974324, 9.238586340184634, 7.263920631194154, 5.575687367446725, 4.139653751887188, 3.281479982680533, 2.8935758267390814, 2.593953821573798, 2.3637465225313856, 2.1669330171747045, 2.0340090774146797, 1.7993926163612002, 1.23168186544788, 0.6923358840057608, 0.4562767508627738, 0.30377407828004893, 0.3998836910817154, 0.28627344255867215, 0.2896444097296397],
[104.83200845336727, 48.789264628719245, 35.79542518159435, 26.191202622053368, 18.631565677628632, 13.156760248767277, 9.278072249276178, 7.557808225608314, 6.527344141976865, 5.8221588098257095, 5.300153051948832, 4.892342576268524, 4.56442401244117, 4.059444229506236, 2.786965298047158, 1.5951607841689275, 1.050412007078834, 0.8066232240898012, 0.5625, 0.570087712549569, 0.45069390943299864],
[4.170789895765713, 2.2813892075776088, 1.8722977401374041, 1.581998811217018, 1.1680659072302333, 0.8971649273413453, 0.6714122254370943, 0.5479607526189125, 0.4952685725635247, 0.4540907427442057, 0.423016289856797, 0.39117791723590156, 0.37682460157239794, 0.35769319795595034, 0.29141313316079676, 0.2558418690403864, 0.27393913225397626, 0.24998776697320674, 0.3945434259097501, 0.3494102314590065, 0.28200978594743026],
[13.608645092551694, 8.517947960942045, 7.731070385173232, 7.013867441173387, 5.4214571112160375, 4.252085085943877, 3.122328111417777, 2.4888579614810173, 2.1757266452764323, 1.9459939464060227, 1.767510390132128, 1.5978729543142927, 1.5012341594507106, 1.3521032941574427, 0.921286615029392, 0.5142555182859491, 0.34424451029730574, 0.19306345586143225, 0.3549671822820029, 0.2840175048640845, 0.2328695574871124],
[22.94763291004955, 12.544201000115978, 10.403965549269415, 8.852830660244747, 6.653876665692002, 5.15389551124291, 3.748963875758711, 3.022558585430357, 2.648200415638697, 2.364421854162231, 2.128611604871097, 1.9857290668595797, 1.8958416638429318, 1.6333855327762186, 1.1091649365291751, 0.6346757679800459, 0.44016704773936566, 0.24759868375632257, 0.37028572011057753, 0.27226722383667096, 0.22652115918763105]
]

cvMatrix25=[[13.377504790696163, 11.68216076480183, 10.76926842320643, 9.085750712908848, 6.134822434635835, 4.524981030986731, 3.2272627537663183, 2.639295375948485, 2.2159656102815113, 1.9574370170291862, 1.7523805253398568, 1.5839052184449538, 1.4442674333111725, 1.230435680290719, 0.7638026773310732, 0.4993512784275837, 0.33639735493621215, 0.18102911000251293, 0.3671501795411073, 0.30984736477809716, 0.2020533772825381], [13.638271263280505, 11.96601031617972, 10.914902647793506, 9.134635828728381, 6.057556748097598, 4.37591561026376, 3.095410799188995, 2.510036389393457, 2.122872806842236, 1.8468289349242466, 1.6625795841675481, 1.4889961533463032, 1.3678236185300963, 1.1516535516756423, 0.7045990186152453, 0.4665920303096635, 0.30365396669470446, 0.16140629751409563, 0.35249413492581344, 0.29631912932398424, 0.18430941640008378], [13.787660886384707, 11.648330475397804, 10.709680132066753, 9.259082208597095, 6.343921922856866, 4.616750801572216, 3.2647841609728903, 2.646044017995833, 2.225181175181575, 1.9438771561109816, 1.7380781834892525, 1.5585756593114377, 1.4262120200737516, 1.1926622843875037, 0.7345746437574102, 0.47082796349743544, 0.3015449400300207, 0.18597716148977536, 0.34993649714123554, 0.3161466010479583, 0.2373739429577445], [8.44125289865985, 7.743909194786778, 7.376435508923703, 6.537648491436713, 4.603583938212427, 3.4238837980554138, 2.472365771789091, 
2.0519004620476125, 1.745339996998628, 1.549040662004584, 1.37539410846223, 1.25596489526315, 1.144686481966751, 0.9693283416411905, 0.5904500893345843, 0.4080987144698418, 0.2819471319687429, 0.16526955326607223, 0.34818547133691974, 0.304313465918987, 0.2114139365887799], [11.376944352318416, 10.429175656945528, 9.850527500894287, 8.528994620111664, 5.788500257247027, 4.215364250107008, 2.9824776992069464, 2.4000646269825756, 2.018127134620392, 1.7543260584611382, 1.5709555180120098, 1.4008114681600183, 1.2715413890980687, 1.0587838512434484, 0.6369747027236113, 0.41075490761165623, 0.27824885301437324, 0.1707130708190409, 0.34436575893097554, 0.31163889618722546, 0.2153199556846855], 
[11.305630231768376, 10.416650798128641, 9.839148577364908, 8.601803655372732, 5.942973799963232, 4.352120804645938, 3.087056497625475, 2.490588636127626, 2.095600750549612, 
1.8242412310019904, 1.6295943327891906, 1.463286263965332, 1.3335075897207402, 1.1103236485279095, 0.660515265149859, 0.4480464303710908, 0.31097570173647165, 0.19415258273825642, 0.3558009049920342, 0.32988284810122653, 0.23855480409213753], [10.386768317841995, 10.074308933607298, 9.48935118020666, 8.213558553903868, 5.677277317614066, 4.156994621906872, 2.9555159083412206, 2.40215985953031, 2.0201685043579785, 1.763697606629068, 1.5794346661893868, 1.415043425770129, 1.2901641651718292, 1.0825027245347392, 0.6513216877590741, 0.43366422300376734, 0.2926577828835096, 0.17322787532794676, 0.3504311058839833, 0.3136923919946656, 0.21118851657764529]]

logTime=[log(i) for i in timeIntervalList] 
for index,cvList in enumerate(cvMatrix25):
    logcv=[log(i) for i in cvList]
    plt.scatter(logTime,logcv,s=10,label=str(chosenChannels[index]))
plt.xlabel("log(Delta)")
plt.ylabel("log(C_v)")
plt.title("Culture 1-3, Div 25, Various Channels")
# plt.savefig('C:/Users/Neel/OneDrive/Documents/Summer Research Project/Figures/Scatter4.eps', format='eps')
plt.legend(loc='upper right');
plt.show()
print(linregress(logTime[2:-3], logcv[2:-3]))